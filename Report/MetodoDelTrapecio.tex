%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Plantilla básica de Latex en Español.
%
% Autor: Andrés Herrera Poyatos (https://github.com/andreshp) 
%
% Es una plantilla básica para redactar documentos. Utiliza el paquete fancyhdr para darle un
% estilo moderno pero serio.
%
% La plantilla se encuentra adaptada al español.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%-----------------------------------------------------------------------------------------------------
%	INCLUSIÓN DE PAQUETES BÁSICOS
%-----------------------------------------------------------------------------------------------------

\documentclass{article}


%-----------------------------------------------------------------------------------------------------
%	SELECCIÓN DEL LENGUAJE
%-----------------------------------------------------------------------------------------------------

% Paquetes para adaptar Látex al Español:
\usepackage[spanish,es-noquoting, es-tabla, es-lcroman]{babel} % Cambia 
\usepackage[utf8]{inputenc}                                    % Permite los acentos.
\selectlanguage{spanish}                                       % Selecciono como lenguaje el Español.

%-----------------------------------------------------------------------------------------------------
%	SELECCIÓN DE LA FUENTE
%-----------------------------------------------------------------------------------------------------

% Fuente utilizada.
\usepackage{courier}                    % Fuente Courier.
\usepackage{microtype}                  % Mejora la letra final de cara al lector.

%-----------------------------------------------------------------------------------------------------
%	IMÁGENES
%-----------------------------------------------------------------------------------------------------

\usepackage{float}

%-----------------------------------------------------------------------------------------------------
%	ESTILO DE PÁGINA
%-----------------------------------------------------------------------------------------------------

% Paquetes para el diseño de página:
\usepackage{fancyhdr}               % Utilizado para hacer títulos propios.
\usepackage{lastpage}               % Referencia a la última página. Utilizado para el pie de página.
\usepackage{extramarks}             % Marcas extras. Utilizado en pie de página y cabecera.
\usepackage[parfill]{parskip}       % Crea una nueva línea entre párrafos.
\usepackage{geometry}               % Asigna la "geometría" de las páginas.

% Se elige el estilo fancy y márgenes de 3 centímetros.
\pagestyle{fancy}
\geometry{left=3cm,right=3cm,top=3cm,bottom=3cm,headheight=1cm,headsep=0.5cm} % Márgenes y cabecera.
% Se limpia la cabecera y el pie de página para poder rehacerlos luego.
\fancyhf{}

% Espacios en el documento:
\linespread{1.1}                        % Espacio entre líneas.
\setlength\parindent{0pt}               % Selecciona la indentación para cada inicio de párrafo.

% Cabecera del documento. Se ajusta la línea de la cabecera.
\renewcommand\headrule{
	\begin{minipage}{1\textwidth}
	    \hrule width \hsize 
	\end{minipage}
}

% Texto de la cabecera:
\lhead{\subject}                          % Parte izquierda.
\chead{}                                    % Centro.
\rhead{\doctitle \ - \docsubtitle}              % Parte derecha.

% Pie de página del documento. Se ajusta la línea del pie de página.
\renewcommand\footrule{                                 
\begin{minipage}{1\textwidth}
    \hrule width \hsize   
\end{minipage}\par
}

\lfoot{}                                                 % Parte izquierda.
\cfoot{}                                                 % Centro.
\rfoot{Página\ \thepage\ de\ \protect\pageref{LastPage}} % Parte derecha.


%----------------------------------------------------------------------------------------
%   MATEMÁTICAS
%----------------------------------------------------------------------------------------

% Paquetes para matemáticas:                     
\usepackage{amsmath, amsthm, amssymb, amsfonts, amscd} % Teoremas, fuentes y símbolos.
     
 % Nuevo estilo para definiciones
 \newtheoremstyle{definition-style} % Nombre del estilo
 {5pt}                % Espacio por encima
 {0pt}                % Espacio por debajo
 {}                   % Fuente del cuerpo
 {}                   % Identación: vacío= sin identación, \parindent = identación del parráfo
 {\bf}                % Fuente para la cabecera
 {.}                  % Puntuación tras la cabecera
 {.5em}               % Espacio tras la cabecera: { } = espacio usal entre palabras, \newline = nueva línea
 {}                   % Especificación de la cabecera (si se deja vaía implica 'normal')
 
 % Nuevo estilo para teoremas
 \newtheoremstyle{theorem-style} % Nombre del estilo
 {5pt}                % Espacio por encima
 {0pt}                % Espacio por debajo
 {\itshape}           % Fuente del cuerpo
 {}                   % Identación: vacío= sin identación, \parindent = identación del parráfo
 {\bf}                % Fuente para la cabecera
 {.}                  % Puntuación tras la cabecera
 {.5em}               % Espacio tras la cabecera: { } = espacio usal entre palabras, \newline = nueva línea
 {}                   % Especificación de la cabecera (si se deja vaía implica 'normal')
 
 % Nuevo estilo para ejemplos y ejercicios
 \newtheoremstyle{example-style} % Nombre del estilo
 {5pt}                % Espacio por encima
 {0pt}                % Espacio por debajo
 {}                   % Fuente del cuerpo
 {}                   % Identación: vacío= sin identación, \parindent = identación del parráfo
 {\scshape}                % Fuente para la cabecera
 {:}                  % Puntuación tras la cabecera
 {.5em}               % Espacio tras la cabecera: { } = espacio usal entre palabras, \newline = nueva línea
 {}                   % Especificación de la cabecera (si se deja vaía implica 'normal')
 
 % Teoremas:
 \theoremstyle{theorem-style}  % Otras posibilidades: plain (por defecto), definition, remark
 \newtheorem{theorem}{Teorema}[section]  % [section] indica que el contador se reinicia cada sección
 \newtheorem{corollary}[theorem]{Corolario} % [theorem] indica que comparte el contador con theorem
 \newtheorem{lemma}[theorem]{Lema}
 \newtheorem{proposition}[theorem]{Proposición}
 
 % Definiciones, notas, conjeturas
 \theoremstyle{definition}
 \newtheorem{definition}{Definición}[section]
 \newtheorem{conjecture}{Conjetura}[section]
 \newtheorem*{note}{Nota} % * indica que no tiene contador
 
 % Ejemplos, ejercicios
 \theoremstyle{example-style}
 \newtheorem{example}{Ejemplo}[section]
 \newtheorem{exercise}{Ejercicio}[section]

%-----------------------------------------------------------------------------------------------------
%	BIBLIOGRAFÍA
%-----------------------------------------------------------------------------------------------------

\usepackage[backend=bibtex, style=numeric]{biblatex}
\usepackage{csquotes}

\addbibresource{references.bib}

%-----------------------------------------------------------------------------------------------------
%	PORTADA
%-----------------------------------------------------------------------------------------------------

% Elija uno de los siguientes formatos.
% No olvide incluir los archivos .sty asociados en el directorio del documento.
\usepackage{title1}
%\usepackage{title2}
%\usepackage{title3}

%-----------------------------------------------------------------------------------------------------
%	TÍTULO, AUTOR Y OTROS DATOS DEL DOCUMENTO
%-----------------------------------------------------------------------------------------------------

% Título del documento.
\newcommand{\doctitle}{Ecuaciones diferenciales ordinarias}
% Subtítulo.
\newcommand{\docsubtitle}{Método del trapecio}
% Fecha.
\newcommand{\docdate}{1 \ de \ Enero \ de \ 2015}
% Asignatura.
\newcommand{\subject}{Métodos Numéricos II}
% Autor.
\newcommand{\docauthor}{Andrés Herrera Poyatos \\ Javier Poyatos Amador \\ Rodrigo Raya Castellano}
\newcommand{\docaddress}{Universidad de Granada}
\newcommand{\docemail}{}

%-----------------------------------------------------------------------------------------------------
%	RESUMEN
%-------------------------------					----------------------------------------------------------------------

% Resumen del documento. Va en la portada.
% Puedes también dejarlo vacío, en cuyo caso no aparece en la portada.
%\newcommand{\docabstract}{}
\newcommand{\docabstract}{En este texto puedes incluir un resumen del documento. Este informa al lector sobre el contenido del texto, indicando el objetivo del mismo y qué se puede aprender de él.}

\begin{document}

\maketitle

%-----------------------------------------------------------------------------------------------------
%	ÍNDICE
%-----------------------------------------------------------------------------------------------------

% Profundidad del Índice:
%\setcounter{tocdepth}{1}

\newpage
\tableofcontents
\newpage

%-----------------------------------------------------------------------------------------------------
%	SECCIÓN 1: MOTIVACIÓN
%-----------------------------------------------------------------------------------------------------

\section{Motivación: ecuaciones diferenciales ordinarias de primer orden} \label{sec:motivacion}

	\begin{definition} 
		Dada una función $f:\Omega \subseteq \mathbb R^2  \to \mathbb{R}$ continua, una un problema de valores iniciales de primer orden consiste en encontrar aquellas funciones $y: [a,b] \rightarrow \mathbb{R}$ de clase 1 que verifiquen $G(y) \subset \Omega$, $y'(t) = f(t,y(t)) \ \forall t \in [a,b]$ y la condición inicial $y(a) = y_0$.  
	\end{definition}

	De forma simplificada, un problema de valores iniciales se representa de la siguiente forma: 
	\begin{equation*}
		\begin{cases}
			y'(t) = f(t,y(t)) \\
			y(a) = y_0 \\
			t \in [a,b]
		\end{cases}
	\end{equation*}

	Resolver de forma exacta un problema de valores iniciales es muy difícil. Existen ecuaciones diferenciales como (poner un ejemplo) de las cuales no se conoce una solución exacta. Sin embargo, sí se conocen múltiples resultados que permiten asegurar la existencia y unicidad de soluciones de la ecuación diferencial.


	Uno de los objetivos de la teoría del Análisis numérico en el campo de las ecuaciones diferenciales ordinarias es resolver de forma aproximada problemas de valores iniciales una vez se conoce la existencia y unicidad de soluciones. Para ello, se toman $n+1$ puntos $t_0, t_1, \ldots, t_n \in [a.b]$ con $a = t_0 < t_1 < \ldots < t_n = b$ y se intenta aproximar la imagen de la solución del problema de valores iniciales en estos puntos. Es habitual denotar a las aproximaciones obtenidas $w_i$ y al error de aproximación cometido $e_i = y(t_i) - w_i$.


	La primera idea intuitiva para resolver este problema consiste en interpretar la primera ecuación como un campo vectorial aprovechando la definición de derivada como aproximación lineal de la función en un punto. Esto es, $f$ le asigna a cada punto la dirección en la que varía cualquier solución del problema que pase por ese punto.

	\begin{figure}[h]
		\centering
		\includegraphics[width=4cm]{./Images/interpret-pvi.png}
		\caption{Representación del campo vectorial asociado a la ecuación logística $y'(t) = c y(t) (1 - y(t))$.} 
		\label{fig:interpret-pvi}
	\end{figure}

	Si conocemos la imagen de la solución $y$ en un punto $t_{i-1}$, entonces sabemos que en ese punto la función variará en la dirección dada por el campo vectorial comentado previamente. Esta es pues la dirección de la recta tangente a $y$ en $t_{i-1}$. Podemos utilizar la imagen de esta recta tangente en $t_{i+1}$ para aproximar $y(t_{i+1})$. Si repetimos el proceso para aproximar $y(t_{i+2})$ a partir de $w_{i+1}$ De este modo nace el método de Euler cuya expresión resumida es la siguiente:

	\begin{center}
		$\begin{cases}
		w_0=y_0 \\
		h_{i} = t_{i+1} - t_i \\
		w_{i+1} = w_i + h_{i} f(t_i,w_i)
		\end{cases}$
	\end{center}
	
	Habitualmente se aproximan puntos equidistantes, esto es, $h = \frac{b-a}{n}$ y $t_i = a + ih \ \forall i = 0 \ldots n$. El estudio del método de Euler concluye que el error de aproximación es.............
	
	Aunque a priori puede parecer que el método de Euler es válido en cualquier aplicación simplemente reduciendo el valor de $h$, esto es, aproximando un mayor número de puntos. Sin embargo. a continuación estudiaremos un ejemplo para el cual el método de Euler requiere una excesiva cantidad de puntos para obtener un error de aproximación aceptable. Previamente, necesitamos conocer algunos resultados básicos sobre la existencia, unicidad y condicionamiento de las soluciones:
	
	\begin{theorem}
		Sea $f: [a,b]\times[\alpha,\beta] \rightarrow \mathbb{R}$ e $y_0 \in (\alpha,\beta)$. Entonces:
		\begin{enumerate}
			\item Si f es Lipschitz en $[a,b]\times[\alpha,\beta]$, entonces existe $c \in [a,b]$ tal que el problema de valores iniciales:
			\begin{center}
				$\begin{cases}
				y'(t) = f(t,y(t)) \\
				y(a) = y_0 \\
				t \in [a,c] \\
				\end{cases}$
			\end{center}
			tiene exactamente una solución. 
			\item Si f es Lipschitz en $[a,b]\times]-\infty,\infty[$, entonces existe exactamente una solución en $[a,b]$
			\item (Condicionamiento) Si f es Lipschitz en $[a,b]\times[\alpha,\beta]$ e y(t), z(t) son soluciones en $[a,b]\times[\alpha,\beta]$ de los problema de valores iniciales con ecuación $y'(t) = f(t,y(t))$ y condiciones iniciales $y(a)$ y $z(a)$, respectivamente, entonces $|y(t)-z(t)| \leq e^{L(t-a)}|y(a)-z(a)|$ donde L es la constante de Lipschitz de f.
		\end{enumerate}
	\end{theorem}
	
	Necesitamos también medir de algún modo cómo de bueno es el procedimiento utilizado para aproximar la solución del problema para ello se introduce la siguiente:
	
	\begin{definition} Sean $w_i$ los valores estimados en los puntos $t_i$ por cierto método de aproximación de las soluciones del problema de valores iniciales:
	\begin{center}
	$\begin{cases}
	y'(t) = f(t,y(t)) \\
	y(a) = y_a \\
	t \in [a,b] \\
	\end{cases}$
	\end{center}
	e $y_i$ los valores exactos de la solución en los puntos $t_i$. Sea también $z(t_i)$ el valor de la solución exacta al problema de valores iniciales:
	\begin{center}
	$\begin{cases}
	y'(t) = f(t,y(t)) \\
	y(t_i) = w_i \\
	t \in [t_i,t_{i+1}] \\
	\end{cases}$
	\end{center}
	Definimos:
	\begin{itemize}
	\item Error global de truncatura o error acumulado en el nodo i-ésimo: $g_i=|w_i-y_i|$
	\item Error local de truncatura o error en un paso: $e_{i+1} = |w_i-z(t_{i+1})|$
	\end{itemize} 
	\end{definition}
	
	El error global cometido en cualquier paso puede verse entonces como la suma del error local y el error global acumulado o amplificado. Para el método de Euler los errores global y local pueden visualizarse fácilmente:
	
	\begin{figure}[h]
	\centering
	\includegraphics[width=10cm]{./Images/error-euler.png}
	\caption{Error local y global cometido por el método de Euler} 
	\label{fig:error-euler}
	\end{figure}
	
	La relación entre errores locales y errores globales viene dada por el siguiente:
	
	\begin{theorem}
	Si f es Lipschitz con constante L, $y_i$ son los valores de la solución a un problema de valores iniciales en puntos $t_i$ en $[a,b]$ y son aproximados por valores $w_i$ mediante cierto método de aproximación con errores locales $e_i \leq c h^{k+1}$ entonces $g_i \le \frac{c h^k}{L} (e^{L(t_i-a)}-1)$ (1).
	\end{theorem}
	
	\begin{definition} Si un método verifica (1) cuando $h \to 0$ entonces se dice que tiene orden k.
	\end{definition}
	
	Veamos ya por qué se requieren métodos más precisos para conseguir una precisión razonable mediante una cantidad razonable de cómputos.
	
	\begin{example} Considérese el siguiente problema de valores iniciales
		\begin{center}
			$\begin{cases}
			y'(t) = -4 t^3 y^2 \\
			y(-10) = 1/10001 \\
			t \in [-10,0] \\
			\end{cases}$
		\end{center}
		La solución exacta de este problema es $y(t)=\frac{1}{1+t^4}$. Sin embargo, la Tabla X muestra los resultados de aproximación obtenidos por el método de euler en $y(0)$ para distintos valores de $h$. Se observa que la aproximación obtenida  deja mucho que desear a pesar de haber llegado a utilizar hasta un millón de puntos. 
	\end{example}

	\textbf{Javi, hazte una tabla.}

%-----------------------------------------------------------------------------------------------------
%	SECCIÓN 2: MÉTODO DEL TRAPECIO
%-----------------------------------------------------------------------------------------------------

\section{Descripción del método del trapecio}

	El método del trapecio se basa en la siguiente proposición:

	\begin{proposition} \label{prop:sol-eq}
		Considérese el problema de valores iniciales dado por la ecuación diferencial $y'(t) = f(t,y(t))$ sobre $[a,b]$ y la condición $y(t_0) = y_0$.  Entonces, son equivalentes:
		\begin{enumerate}
			\item $y$ es una solución del problema de valores iniciales.
			\item $y(t) = y_0 + \int_{t_0}^{t} f(s,y(s))) ds \ \forall t \in [a,b]$
		\end{enumerate}
	\end{proposition}
	
	\begin{proof}
		Es consecuencia directa del Teorema Fundamental del Cálculo.
	\end{proof}

	
	Utilizando la Proposición \ref{prop:sol-eq}, si un PVI con condición inicial $t_0 = a$, $y(t_0) = y_0$ tiene solución única, entonces esta es la única solución de la siguiente ecuación
	
	\begin{equation}
		y(t)  = y_0 + \int_{t_0}^{t} f(s,y(s))) \ ds
	\end{equation}
	
	En este contexto se pueden aplicar los métodos de integración numérica para aproximar la integral que aparece en la segunda igualdad. Para ello supóngase que $f$ es diferenciable. En tal caso una obvia inducción concluye que $y$ es de clase infinito. Por tanto, se puede utilizar la fórmula del trapecio para integración numérica, obteniendo la siguiente igualdad
	
	\begin{equation} \label{eq:trapecio-igualdad}
		y(t_{1}) = y_0 + \frac{h}{2} \left[f(t_0,y_0) + f(t_1, y(t_1))\right] - \frac{h^3}{12}y^{3)}(\xi)
	\end{equation}


	donde $\xi \in [t_0, t_1]$. Ignorando el último sumando se obtiene la aproximación dada en (\ref{eq:app}), que tiene error $- \frac{h^3}{12}y^{3)}(\xi)$.

	\begin{equation} \label{eq:app}
		y(t_1) \approx w_1 = w_0 + \frac{h}{2} \left[f(t_0,w_0) + f(t_1, y(t_1))\right]
	\end{equation}

	El problema reside en que para aproximar el valor de $y$ en $t_1$ se debe conocer previamente dicho valor. En este contexto se plantean dos soluciones diferentes obteniendo dos métodos, denominados método del trapecio explícito e iterativo respectivamente. En el resto del texto se desarrollan sendos métodos, proporcionando el error teórico cometido y resultados de convergencia y estabilidad.
	
	\subsection{Método del trapecio explícito}
		
		Recuérdese en este punto el método de Euler para ecuaciones diferenciales ordinarias que se comentó en la Sección \ref{sec:motivacion}. Denotemos $w'_i$ a las aproximaciones obtenidas por este método. El valor de la solución en cada punto se aproxima a partir del anterior mediante la siguiente expresión:
		
		\begin{equation*} \label{eq:euler}
			y(t_{k+1}) \approx w'_{i+1} = w'_i + h f(t_i,w'_i))
		\end{equation*}

		Se comentó previamente que el problema de la aproximación (\ref{eq:app}) reside en que el valor a aproximar aparece en el segundo miembro de la expresión. Para solventar este hecho se puede utilizar la aproximación dada por el método de Euler en su lugar. De esta forma se obtiene la siguiente aproximación:

		\begin{equation} \label{eq:app-exp}
			y(t_{k+1}) \approx w_{i+1} = w_i + \frac{h_i}{2} \left[f(t_i,w_i) + f(t_{i+1}, w_i + h_if(t_i,w_i))\right]
		\end{equation}

		Sean $S_L = h_i(1, f(t_i,w_i)) $ y $S_R = h_i(1, f(t_{i+1}, w'_{i+1}) )$. El método de Euler  obtiene $(t_{i+1}, w'_{i+1})$ sumándole $S_L$ a $(t_{i}, w_{i})$ . Por su parte, el método del trapecio explícito obtiene $(t_{i+1}, w_{i+1})$ como $(t_{i}, w_{i})$ más la media de $S_L$ y $S_R$. La Figura \ref{fig:trapecio-vs-euler} muestra este hecho de forma visual.
			
		\begin{figure}[H]
			\centering
			\includegraphics[width=10cm]{./Images/trapecio-vs-euler.png}
			\caption{Esquema visual del método del trapecio explícito. \textbf{¡Pasar a Español!}} 
			\label{fig:trapecio-vs-euler}
		\end{figure}

	\subsection{Método del trapecio iterativo}
	
		Supóngase que se ha calculado una aproximación inicial para cada $t_i$. Estas aproximaciones se denotan $w_i^{(0)}$. Si estas aproximaciones son buenas, la expresión (\ref{eq:app}) sugiere evaluar el miembro de la derecha con las aproximaciones $w_i^{(0)}$ para obtener una nueva aproximación. De esta forma se define
		
		\begin{equation} \label{eq:ti-def}
			w_{i+1} ^{(j+1)} = y_i + \frac{h}{2} \left[f(t_i, y_i) + f(t_{i+1}, w_{i+1}^{j})\right]
		\end{equation}

		Las aproximaciones iniciales se obtienen habitualmente mediante un método explícito como el anterior. La idea consiste en aproximar mediante una secuencia de iteraciones el valor $y_i$ y utilizar esta nueva aproximación para aproximar mediante otra nueva secuencia de iteraciones $y_{i+1}$. Un primer resultado básico es el siguiente:
		
		\begin{proposition}
			Si la función $f$ es Lipschitziana con constante de Lipschitz $L$ verificando $\frac{hL}{2} < 1$, entonces la sucesión $\{w_i^{(j)}\}$ converge a $y_i$ cuando $j \rightarrow +\infty$. 
		\end{proposition}

		\begin{proof}
			Se pretende acotar $y_{i+1} - w_{i+1}^{(j+1)}$. Para ello, se resta a la igualdad (\ref{eq:trapecio-igualdad}) sobre $y_i$ la expresión \ref{eq:ti-def}, obteniendo
			
			\begin{equation}
				y_{i+1} - w_{i+1}^{(j+1)} = \frac{h}{2} \left[f(t_{i+1},y_{i+1}) - f(t_{i+1}, w_{i+1}^{(j)})\right] - \frac{h^3}{12}y^{3)}(\xi)
			\end{equation}
			
			Tomando valores absolutos y haciendo mucha magia
		\end{proof}




%-----------------------------------------------------------------------------------------------------
%	SECCIÓN X: ERROR
%-----------------------------------------------------------------------------------------------------


\section{Estudio del error}

	\subsection{Método del trapecio explícito}
	
	\subsection{Método del trapecio iterativo}


%-----------------------------------------------------------------------------------------------------
%	SECCIÓN X: ESTABILIDAD
%-----------------------------------------------------------------------------------------------------

\section{Convergencia y Estabilidad}

%-----------------------------------------------------------------------------------------------------
%	SECCIÓN X: CONCLUSIÓN
%-----------------------------------------------------------------------------------------------------

\section{Conclusión}


%-----------------------------------------------------------------------------------------------------
%	SECCIÓN X: REFERENCIAS
%-----------------------------------------------------------------------------------------------------

\printbibliography


\end{document}
